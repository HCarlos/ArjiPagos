import{k as g,Y as S,j as k,p as V,$ as v,J as C,K as E,d as n,o as r,e as w,u as M,m as $,w as U,f as s,x as j,s as x,F as h,q as f,t as l,y as F,v as D,g as I,a as A}from"./vendor-Mf1CNb9E.js";import{_ as q}from"./AuthenticatedLayout-DVEoqzbI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"p-4 bg-white rounded-lg shadow-xs"},K={class:"contenedor"},L={class:"mb-8"},O=["value"],Q={key:0,class:"flex gap-6 items-stretch"},T={class:"panel"},Y={class:"panel-header"},z={class:"text-lg font-semibold"},G={class:"list-contenedor"},H={class:"flex items-center w-full cursor-pointer space-x-3"},P=["value"],R={class:"text-gray-700"},W={class:"transfer-buttons"},X=["disabled"],Z=["disabled"],ee={class:"panel"},se={class:"panel-header"},ae={class:"text-lg font-semibold"},te={class:"list-contenedor"},le={class:"flex items-center w-full cursor-pointer space-x-3"},oe=["value"],ne={class:"text-gray-700"},ce={__name:"BulkUserEntitiesAssignment",props:{users:Array,allDatas:Array,assignedDatasByUser:Object,tableName:String,addUrl:String,removeUrl:String,totalAlumnos:Number},setup(d){const m=d,t=g(null),i=g([]),c=g([]),b=S({...m.assignedDatasByUser}),_=k(()=>t.value?b[t.value]||[]:[]),y=k(()=>{const o=_.value.map(a=>a.id);return m.allDatas.filter(a=>!o.includes(a.id))}),N=async()=>{var o,a;try{const e=await A.post(m.addUrl,{user_id:t.value,datas:i.value});b[t.value]=e.data.data[t.value],i.value=[]}catch(e){alert("Error al asignar: "+((a=(o=e.response)==null?void 0:o.data)==null?void 0:a.message)||e.message)}},B=async()=>{var o,a;try{const e=await A.post(m.removeUrl,{user_id:t.value,datas:c.value});b[t.value]=e.data.data[t.value],c.value=[]}catch(e){alert("Error al remover: "+((a=(o=e.response)==null?void 0:o.data)==null?void 0:a.message)||e.message)}},u=g(null);return V(()=>{v(u.value).select2(),v(u.value).on("change",function(){t.value=v(this).val()})}),C(t,o=>{v(u.value).val(o).trigger("change")}),E(()=>{v(u.value).select2("destroy")}),(o,a)=>(r(),n(h,null,[w(M($),{title:`Asignación de ${d.tableName}`},null,8,["title"]),w(q,null,{header:U(()=>[I(" Asignación de "+l(d.tableName),1)]),default:U(()=>[s("div",J,[s("div",K,[s("div",L,[a[4]||(a[4]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Seleccionar usuario: ",-1)),x(s("select",{ref_key:"selectUser",ref:u,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),class:"select-style user-select"},[a[3]||(a[3]=s("option",{value:null},"-- Seleccione un usuario --",-1)),(r(!0),n(h,null,f(d.users,e=>(r(),n("option",{key:e.id,value:e.id},l(e.full_name)+" - "+l(e.username),9,O))),128))],512),[[F,t.value]])]),t.value?(r(),n("div",Q,[s("div",T,[s("div",Y,[s("h3",z,l(d.tableName)+" disponibles ("+l(y.value.length)+")",1)]),s("div",G,[(r(!0),n(h,null,f(y.value,e=>(r(),n("div",{key:e.id,class:"list-item"},[s("label",H,[x(s("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":a[1]||(a[1]=p=>i.value=p),class:"form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300"},null,8,P),[[D,i.value]]),s("span",R,l(e.data)+" - ("+l(e.id)+")",1)])]))),128))])]),s("div",W,[s("button",{onClick:N,disabled:!i.value.length,class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white"}," Agregar → ",8,X),s("button",{onClick:B,disabled:!c.value.length,class:"btn-action bg-rose-600 hover:bg-rose-700 text-white"}," ← Quitar ",8,Z)]),s("div",ee,[s("div",se,[s("h3",ae,l(d.tableName)+" asignados ("+l(_.value.length)+")",1)]),s("div",te,[(r(!0),n(h,null,f(_.value,e=>(r(),n("div",{key:e.id,class:"list-item"},[s("label",le,[x(s("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":a[2]||(a[2]=p=>c.value=p),class:"form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300"},null,8,oe),[[D,c.value]]),s("span",ne,l(e.name)+" - ("+l(e.id)+")",1)])]))),128))])])])):j("",!0)])])]),_:1})],64))}};export{ce as default};
